<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluación Empleado vs Socio - Sliders Correlativos</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1 { text-align: center; }
        .section { margin-bottom: 30px; }
        .slider-container { margin-bottom: 15px; position: relative; }
        label { display: block; font-weight: bold; }
        input[type="range"] { width: 100%; transition: all 0.3s ease; }
        .output { font-weight: bold; color: #007bff; }
        .scores { display: flex; justify-content: space-around; }
        .score-bar { width: 40%; background: #f0f0f0; border: 1px solid #ccc; height: 30px; position: relative; }
        .bar-fill { height: 100%; background: #4caf50; width: 0; transition: width 0.3s ease; }
        .bar-text { position: absolute; top: 5px; left: 10px; color: #000; }
        .conclusion { text-align: center; font-size: 1.2em; margin-top: 20px; }
        .highlight { background-color: #ffeb3b; transition: background-color 0.5s ease; }
        .tooltip { display: none; position: absolute; background: #333; color: #fff; padding: 5px; border-radius: 3px; font-size: 0.9em; top: -40px; left: 50%; transform: translateX(-50%); }
        .slider-container:hover .tooltip { display: block; }
    </style>
</head>
<body>
    <h1>Evaluación Empleado vs Socio - Sliders Correlativos</h1>
    
    <div class="section">
        <h2>Parámetros Financieros (Sliders Dinámicos)</h2>
        <p>Ajusta los sliders. Cuando el "Factor de participación" supere el 50%, el "Valor por hora" se ajustará automáticamente para equilibrar ingresos.</p>
        
        <div class="slider-container">
            <label for="v_hora">Valor por hora (USD): <span id="v_hora_val">50</span></label>
            <input type="range" id="v_hora" min="0" max="200" value="50" step="1">
            <div class="tooltip">Ajustado por participación si > 50%</div>
        </div>
        
        <div class="slider-container">
            <label for="h_empleado">Horas anuales como Empleado: <span id="h_empleado_val">2000</span></label>
            <input type="range" id="h_empleado" min="0" max="3000" value="2000" step="100">
        </div>
        
        <div class="slider-container">
            <label for="h_socio">Horas anuales como Socio: <span id="h_socio_val">400</span></label>
            <input type="range" id="h_socio" min="0" max="3000" value="400" step="100">
        </div>
        
        <div class="slider-container">
            <label for="participacion">Factor de participación (%): <span id="participacion_val">20</span></label>
            <input type="range" id="participacion" min="0" max="100" value="20" step="1">
            <div class="tooltip">Ajusta "Valor por hora" si > 50%</div>
        </div>
        
        <div class="slider-container">
            <label for="profit_empresa">Beneficio anual esperado de la empresa (USD): <span id="profit_empresa_val">500000</span></label>
            <input type="range" id="profit_empresa" min="0" max="1000000" value="500000" step="10000">
        </div>
        
        <div>
            <p class="output">Ingreso anual Empleado: <span id="ingreso_emp">100000 USD</span></p>
            <p class="output">Ingreso anual Socio: <span id="ingreso_soc">100000 USD</span></p>
            <p class="output">Eficiencia Empleado (USD/hora): <span id="eff_emp">50</span></p>
            <p class="output">Eficiencia Socio (USD/hora): <span id="eff_soc">250</span></p>
        </div>
    </div>
    
    <div class="section">
        <h2>Pesos de Variables (Importancia Personal)</h2>
        <p>Ajusta cuánto valoras cada factor (0-10).</p>
        <div id="weights-container"></div>
    </div>
    
    <div class="section">
        <h2>Puntajes Totales</h2>
        <div class="scores">
            <div>
                <h3>Empleado</h3>
                <div class="score-bar"><div class="bar-fill" id="bar_emp"></div><div class="bar-text" id="score_emp">0%</div></div>
            </div>
            <div>
                <h3>Socio</h3>
                <div class="score-bar"><div class="bar-fill" id="bar_soc"></div><div class="bar-text" id="score_soc">0%</div></div>
            </div>
        </div>
        <p class="conclusion" id="conclusion"></p>
    </div>

    <script>
        const variables = [
            {name: "Tiempo invertido", emp: 10, soc: 3, type: "bad"},
            {name: "Control decisiones", emp: 2, soc: 7, type: "good"},
            {name: "Riesgo financiero", emp: 0, soc: 8, type: "bad"},
            {name: "Estabilidad económica", emp: 9, soc: 4, type: "good"},
            {name: "Flexibilidad horaria", emp: 2, soc: 8, type: "good"},
            {name: "Beneficios adicionales", emp: 8, soc: 3, type: "good"},
            {name: "Crecimiento profesional", emp: 6, soc: 7, type: "good"},
            {name: "Compromiso requerido", emp: 10, soc: 4, type: "bad"},
            {name: "Poder de negociación", emp: 3, soc: 6, type: "good"},
            {name: "Participación utilidades", emp: 0, soc: 8, type: "good"},
            {name: "Riesgo laboral", emp: 7, soc: 3, type: "bad"},
            {name: "Costo de oportunidad", emp: 8, soc: 2, type: "bad"}
        ];

        // Generate weight sliders
        const weightsContainer = document.getElementById('weights-container');
        variables.forEach(v => {
            const div = document.createElement('div');
            div.className = 'slider-container';
            div.innerHTML = `
                <label for="weight_${v.name}">${v.name} (Importancia): <span id="weight_${v.name}_val">5</span></label>
                <input type="range" id="weight_${v.name}" min="0" max="10" value="5" step="1">
            `;
            weightsContainer.appendChild(div);
        });

        const dynamicWeights = ['Ingresos esperados', 'Eficiencia económica'];
        dynamicWeights.forEach(name => {
            const div = document.createElement('div');
            div.className = 'slider-container';
            div.innerHTML = `
                <label for="weight_${name}">${name} (Importancia): <span id="weight_${name}_val">5</span></label>
                <input type="range" id="weight_${name}" min="0" max="10" value="5" step="1">
            `;
            weightsContainer.appendChild(div);
        });

        // Flag to prevent infinite loops
        let isAdjusting = false;

        function updateAll(sourceSlider = null) {
            if (isAdjusting) return; // Prevent recursive updates
            isAdjusting = true;

            // Get inputs
            const v_horaSlider = document.getElementById('v_hora');
            let v_hora = parseFloat(v_horaSlider.value);
            const h_empleado = parseFloat(document.getElementById('h_empleado').value);
            const h_socio = parseFloat(document.getElementById('h_socio').value);
            const participacion = parseFloat(document.getElementById('participacion').value);
            const profit_empresa = parseFloat(document.getElementById('profit_empresa').value);

            // Correlative adjustment: if participación > 50, adjust v_hora to match socio income
            if (sourceSlider === 'participacion' && participacion > 50) {
                const target_income = (participacion / 100) * profit_empresa;
                v_hora = target_income / h_empleado; // Adjust to match socio income
                v_hora = Math.min(200, Math.max(0, v_hora)); // Clamp to slider range
                v_horaSlider.value = v_hora;
                v_horaSlider.parentElement.classList.add('highlight');
                setTimeout(() => v_horaSlider.parentElement.classList.remove('highlight'), 1000);
            }

            // Update displayed values
            document.getElementById('v_hora_val').textContent = v_hora.toFixed(0);
            document.getElementById('h_empleado_val').textContent = h_empleado;
            document.getElementById('h_socio_val').textContent = h_socio;
            document.getElementById('participacion_val').textContent = participacion;
            document.getElementById('profit_empresa_val').textContent = profit_empresa;

            // Calculate incomes
            const ingreso_emp = h_empleado * v_hora;
            const ingreso_soc = (participacion / 100) * profit_empresa;
            document.getElementById('ingreso_emp').textContent = ingreso_emp.toFixed(0) + ' USD';
            document.getElementById('ingreso_soc').textContent = ingreso_soc.toFixed(0) + ' USD';

            // Calculate efficiency
            const eff_emp = h_empleado > 0 ? ingreso_emp / h_empleado : 0;
            const eff_soc = h_socio > 0 ? ingreso_soc / h_socio : 0;
            document.getElementById('eff_emp').textContent = eff_emp.toFixed(2);
            document.getElementById('eff_soc').textContent = eff_soc.toFixed(2);

            // Compute scores for dynamic vars
            const max_income = 200000;
            const ingreso_emp_score = Math.min(10, (ingreso_emp / max_income) * 10);
            const ingreso_soc_score = Math.min(10, (ingreso_soc / max_income) * 10);

            const max_eff = 200;
            const eff_emp_score = Math.min(10, (eff_emp / max_eff) * 10);
            const eff_soc_score = Math.min(10, (eff_soc / max_eff) * 10);

            // Calculate total scores
            let total_emp = 0;
            let total_soc = 0;
            let total_weight = 0;

            variables.forEach(v => {
                const w = parseInt(document.getElementById(`weight_${v.name}`).value);
                const norm_emp = v.type === 'good' ? v.emp : 10 - v.emp;
                const norm_soc = v.type === 'good' ? v.soc : 10 - v.soc;
                total_emp += w * norm_emp;
                total_soc += w * norm_soc;
                total_weight += w;
            });

            const w_ing = parseInt(document.getElementById('weight_Ingresos esperados').value);
            total_emp += w_ing * ingreso_emp_score;
            total_soc += w_ing * ingreso_soc_score;
            total_weight += w_ing;

            const w_eff = parseInt(document.getElementById('weight_Eficiencia económica').value);
            total_emp += w_eff * eff_emp_score;
            total_soc += w_eff * eff_soc_score;
            total_weight += w_eff;

            const score_emp_pct = total_weight > 0 ? (total_emp / (total_weight * 10)) * 100 : 0;
            const score_soc_pct = total_weight > 0 ? (total_soc / (total_weight * 10)) * 100 : 0;

            // Update bars and texts
            document.getElementById('score_emp').textContent = score_emp_pct.toFixed(1) + '%';
            document.getElementById('score_soc').textContent = score_soc_pct.toFixed(1) + '%';
            document.getElementById('bar_emp').style.width = score_emp_pct + '%';
            document.getElementById('bar_soc').style.width = score_soc_pct + '%';

            // Conclusion
            let conclusion = '';
            if (score_emp_pct > score_soc_pct) {
                conclusion = 'Basado en tus preferencias, ser Empleado parece mejor.';
            } else if (score_soc_pct > score_emp_pct) {
                conclusion = 'Basado en tus preferencias, ser Socio parece mejor.';
            } else {
                conclusion = 'Ambas opciones parecen equivalentes.';
            }
            document.getElementById('conclusion').textContent = conclusion;

            isAdjusting = false;
        }

        // Add event listeners
        const sliders = document.querySelectorAll('input[type="range"]');
        sliders.forEach(slider => {
            slider.addEventListener('input', () => {
                updateAll(slider.id);
                if (slider.id.startsWith('weight_')) {
                    document.getElementById(slider.id + '_val').textContent = slider.value;
                }
            });
        });

        // Initial update
        updateAll();
    </script>
</body>
</html>
